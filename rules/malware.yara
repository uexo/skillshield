# YARA Rules for SkillShield
# Place custom YARA rules here for advanced pattern matching

rule CredentialStealer {
    meta:
        description = "Detects potential credential stealing patterns"
        severity = "critical"
    strings:
        $env1 = "os.environ"
        $env2 = "getenv"
        $post1 = "requests.post"
        $post2 = "urllib.request"
        $webhook = "webhook"
    condition:
        any of ($env*) and any of ($post*) and $webhook
}

rule SuspiciousNetwork {
    meta:
        description = "Detects suspicious network activity"
        severity = "high"
    strings:
        $pastebin = "pastebin.com"
        $webhook = "webhook.site"
        $requestbin = "requestbin.net"
        $hook = "hook"
    condition:
        any of them
}

rule SystemCommand {
    meta:
        description = "Detects system command execution"
        severity = "medium"
    strings:
        $system = "os.system"
        $subprocess = "subprocess"
        $exec = "exec("
        $eval = "eval("
    condition:
        any of them
}
